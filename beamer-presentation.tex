\documentclass[10pt,aspectratio=149]{beamer}

% Themes and color theme
\usetheme{Boadilla}
\usecolortheme[RGB={8,164,255}]{structure}
\usetheme[height=8mm]{Rochester}

% Custom packages and settings
\input{preambule.tex}

% Beamer templates and font theme
\setbeamertemplate{items}[ball]
\setbeamertemplate{blocks}[rounded][shadow=true]
\setbeamertemplate{navigation symbols}{}
\usefonttheme{structurebold}

% Footline templates
\defbeamertemplate{footline}{centered page number}{ }
\defbeamertemplate{footline}{centered frame number}{ }
\setbeamertemplate{footline}[centered page number]
\setbeamertemplate{footline}[centered frame number]

% TikZ libraries and settings
\usetikzlibrary{datavisualization, patterns}
\usepgfplotslibrary{fillbetween}
\usetikzlibrary{decorations.markings,intersections,calc}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{fit}
\makeatletter
\tikzset{
  fitting node/.style={
    inner sep=0pt,
    fill=none,
    draw=none,
    reset transform,
    fit={(\pgf@pathminx,\pgf@pathminy) (\pgf@pathmaxx,\pgf@pathmaxy)}
  },
  reset transform/.code={\pgftransformreset}
}
\makeatother

% PGFPlots libraries
\usepgfplotslibrary{colormaps}
\usepgfplotslibrary{colorbrewer}
\usepgfplotslibrary{external}

% Additional packages
\usepackage{tikz-3dplot}
\usepgfplotslibrary{groupplots}
\usetikzlibrary{overlay-beamer-styles}
\usetikzlibrary{spy}

% Plot dimensions and paths
\newlength{\plotwidth}
\newlength{\plotheight}
\setlength{\plotheight}{0.85\textheight}
\setlength{\plotwidth}{0.9\textwidth}
\newlength{\plotwidthmesh}
\setlength{\plotwidthmesh}{0.49\textwidth}
\newcommand{\subplotwidth}{0.45\textwidth}
\newcommand{\subplotwidthhp}{0.49\textwidth}
\newcommand{\subplotheight}{\plotwidth}
\newcommand{\figpath}{Figures}

% Include plot_beamer.tex
\input{plot_beamer.tex}

% Author, institute, title, and date
\author{Julen Alvarez-Aramberri \inst{2} \and Vincent Darrigrand \inst{3} \and \underline{Felipe V. Caro }\inst{1,2} \and David Pardo \inst{2,1,4}}
\institute[]{\inst{1} Basque Center for Applied Mathematics (BCAM), Bilbao, Spain \and %
	\inst{2} University of the Basque Country (UPV-EHU), Leioa, Spain \and 
	\inst{3} CNRS-IRIT, Toulouse, France \and 
	\inst{4} Basque Foundation for Science (Ikerbasque), Bilbao, Spain}
\title[ADMOS2023]{Generation of Massive Databases for Deep Learning Inversion: A Goal-Oriented $hp$-Adaptive Strategy}
\date{\normalsize XI International Conference on Adaptive Modeling and Simulation (ADMOS) \\[0.3cm] Gothenburg, Sweden, 19 June 2023}

% Set author, date, and institute colors and fonts
\setbeamercolor{author}{fg=black!80!white}
\setbeamercolor{date}{fg=black!80!white}
\setbeamercolor{institute}{fg=black!60!white}
\setbeamerfont*{date}{family=\sffamily,series=\bf,size=\scriptsize}
\setbeamerfont*{title}{family=\sffamily,series=\bf,size=\large}
\setbeamerfont*{author}{family=\sffamily,series=\bfseries,size=\large}
\setbeamerfont*{institute}{family=\sffamily,series=\bf,size=\scriptsize}

% Begin document
\begin{document}

% Opening frame
\begin{frame}[plain]
\includegraphics[height=0.1\textheight]{Figures/logo_upv}
\hfill
\includegraphics[height=0.1\textheight]{Figures/logo_bcam}
\titlepage
\end{frame} 

% Motivation frame
\begin{frame}
    \frametitle{Motivation: Electromagnetic (EM) Applications}
    \begin{figure}
        \centering
        \begin{subfigure}[b]{0.4\textwidth}
            \centering
            \includegraphics[width=\textwidth]{Figures/csem}
            \caption{CSEM (artificial source)}
        \end{subfigure}
        \hfill
        \begin{subfigure}[b]{0.4\textwidth}
            \centering
            \includegraphics[width=\textwidth]{Figures/magneto}
            \caption{MT (natural source)}
        \end{subfigure}
    \end{figure}
    \vfill
    \begin{block}{Objective}
        \centering
        \textbf{\textcolor{red}{Objective}}: To obtain the \textbf{conductivity/resistivity} distribution of the Earth's subsurface.
    \end{block}
\note[Deep Learning inversion has shown promising results in solving CSEM and MT problems, but it requires large databases for training.]

\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{Motivation: Preliminaries}
	
	\begin{figure}
		\begin{tikzpicture}[x=0.40cm,y=0.40cm]
			\node[punkt,fill=brown!20](resistivity){\footnotesize Physical Properties $(\boldsymbol{m})$};
			\node[punkt, right=6 of resistivity,fill=brown!20](num_sol){\footnotesize Measurements $(\boldsymbol{d})$};
			
			\draw [punkt,->,color=orange] (resistivity.north) to[out=45, in=135] node [anchor=north,swap,sloped,color=orange] {Forward Problem \\ $\calF$} (num_sol.north);
			\draw [punkt,->,color=blue] (num_sol.south) to[out=225, in=-45] node [anchor=south,swap,sloped,color=blue] {$\calI$ \\ Inverse Problem} (resistivity.south);
		\end{tikzpicture}
	\end{figure}

	\begin{block}{Definitions}
		\begin{equation*}
			\begin{array}{lcll}
				\calF & : & \mbox{Forward Operator.}  & \mbox{Physical Properties $(\boldsymbol{m})$} \rightarrow \mbox{Measurements $(\boldsymbol{d})$} \\[2mm]
				\calI & : & \mbox{Inverse Operator.}  &\mbox{Measurements $(\boldsymbol{d})$} \rightarrow \mbox{Physical Properties $(\boldsymbol{m})$} \\[2mm]
				\calI_{\phi} & :& \mbox{Neural Network appr. of } \calI.  &
			\end{array}
		\end{equation*}
	\end{block}
	
\note[Explain that the physical properties of interest are the conductivity distribution in the Earth's subsurface. The measurements or observations are obtained from the physical system. Explain that the forward operator maps the physical properties in the model space to the corresponding measurements in the data space. It represents the physical process or phenomenon that relates the model properties to the observed data. Explain that the inverse operator performs the inverse process, mapping the measured data back to the physical properties in the model space. It is used to estimate or reconstruct the desired properties from the available measurements.  Mention that the inverse operator ($\calI$) can be challenging to construct analytically due to the complexity of the problem. Introduce the idea of using a neural network ($\calI_{\phi}$) as an approximation of the inverse operator.]

%\end{itemize}
\end{frame}
%================================================================================================================
\begin{frame}
    \frametitle{Motivation: Generation of Massive Databases}    
\vspace{-2mm}

\begin{block}{Objective}
	\centering
	Building the \textbf{Inverse Operator} (not just evaluating it).
\end{block}

\begin{block}{Loss Function and Training}
Find $\mathcal{I}_{\phi^*}$ such that
\[
\phi^* = \argmin_{\phi \in \boldsymbol{\Phi}} \sum \left\| (\textcolor{red}{\mathcal{F}} \circ \mathcal{I}_{\phi})(\boldsymbol{d}_i) - \boldsymbol{d}_i \right\|^2
\]
where evaluating $\textcolor{red}{\mathcal{F}}$ is \textcolor{red}{expensive}!
\end{block}
    
\begin{block}{Difficulties}
    \begin{enumerate}
        \item We need a Forward Solver \textcolor{red}{$\mathcal{F}$} for \textcolor{red}{any parameterization} (model).
        \item \textcolor{red}{A huge number} of evaluations needed \textcolor{red}{to train} the DNN.
    \end{enumerate}
\end{block}

\begin{block}{Solution}
    \begin{enumerate}
        \item  \textcolor{red}{Approximate} the Forward Operator with a  \textcolor{red}{Neural Network}.
    \end{enumerate}
\end{block}

\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{Outline}
	\tableofcontents
\end{frame}
%================================================================================================================
\section{A Painless $hp$-Adaptive FEM Strategy for Non-parametric PDEs}
%================================================================================================================
\begin{frame}
    \frametitle{Outline}
    \tableofcontents[currentsection]
\end{frame}
%================================================================================================================
\begin{frame}{A Painless $hp$-Adaptive Strategy for Non-PPDEs}
  \tikzset{/tikz/external/export next=false}
  \begin{center}
    \begin{tikzpicture}
      \node[rounded rectangle, draw, very thick](Init) {Initial coarse mesh};
      \node[below right=1/2 of Init,rounded rectangle, draw, very thick,color=blue,align=center](ref) {Arbitrary \\(user-defined/global)\\ refinements};
      \node[below= of ref, rounded rectangle, draw, very thick,color=green!50!black, align=center](unrefProcess) {Quasi-optimal\\$hp$-unrefinements \\ using the error indicators};
      \node[below right=1/2 of unrefProcess,rounded rectangle, draw, very thick](final) {Adapted mesh};

      \draw[->, thick] (Init) -| (ref);
      \draw[->, thick,color=blue] (ref.east) to[out=0,in=0] (unrefProcess.east);
      \draw[->, thick,color=green!50!black] (unrefProcess.west) to[out=180,in=180] node[pos=0.5](PinExitRef){} (ref.west);
      \draw[->, thick] (unrefProcess) |- (final);
    \end{tikzpicture}
  \end{center}

 \begin{thebibliography}{10}
\beamertemplatearticlebibitems
\scriptsize
\bibitem{darrigrand2020painless}
V. Darrigrand, D. Pardo, T. Chaumont-Frelet, I. G{\'o}mez-Revuelto, L. E. Garc{\'i}a-Castillo
\newblock A painless automatic $hp$-adaptive strategy for elliptic problems
\newblock \emph{Finite Elements in Analysis and Design}, 2020.
\beamertemplatearticlebibitems
\scriptsize
\bibitem{caro2022painless}
F. V. Caro, V. Darrigrand, J. Alvarez-Aramberri, E. Alberdi, D. Pardo
\newblock A painless multi-level automatic goal-oriented $hp$-adaptive coarsening strategy for elliptic and non-elliptic problems
\newblock \emph{Computer Methods in Applied Mechanics and Engineering}, 2022.
\end{thebibliography}
\end{frame}
%================================================================================================================
\begin{frame}[c]
	\frametitle{Illustrating the Goal-Oriented $hp$-Adaptive Strategy}
	\begin{figure}[t!]
   		\goasolutions[unitsquare]{Helm2DGOA}{abs}
	\end{figure}
\end{frame}
%================================================================================================================
\begin{frame}[c]
	\frametitle{Illustrating the Goal-Oriented $hp$-Adaptive Strategy}
  	\plothpmeshes[]{Helm2DGOA}
\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{Illustrating the Goal-Oriented $hp$-Adaptive Strategy}
	\plothpunrefmago{hpmago}
\end{frame}
%================================================================================================================
\begin{frame}{A Painless $hp$-Adaptive Strategy: Key Features}
\textbf{\tcr{Robust} performance across various problem types}
\setlength{\itemsep}{1mm}
\begin{enumerate}
\item Successfully handles 2D and 3D problems.
\item Effective for both elliptic and non-elliptic equations, including Poisson, Helmholtz, and Convection-Dominated problems.
\item Accommodates both Energy-Norm Adaptivity and Goal-Oriented Adaptivity.
\end{enumerate}

\vspace{5mm}

\textbf{Advantages}
\begin{enumerate}
\item \alert{Flexible} code: Supports $hp$-refinements, $h$-refinements (with any $p$), and $p$-refinements (with any $h$).
\item Allows the user to choose the desired type of refinements, providing greater flexibility.
\item \tcr{Efficient implementation}: Utilizes a single mesh, reducing computational overhead.
\item The refining/unrefining steps \alert{rectify} potential \alert{errors} made during earlier (pre-asymptotic) stages.
\end{enumerate}
\end{frame}
%================================================================================================================
\section{Extension to Parametric PDEs: One Grid for all Model Parameters}
%================================================================================================================
\begin{frame}
    \frametitle{Outline}
    \tableofcontents[currentsection]
\end{frame}
%================================================================================================================
\begin{frame}
    \frametitle{One Grid for Multiple Parameters}
    
    \vspace{-1mm}
    \begin{block}{Definitions}
    \begin{itemize}
    \item Let $\m = \{\sig_1, \ldots, \sig_N \}$ be the set of model parameters that parametrize one problem.
    \item Consider $S$ samples of parameters: $\M = \{\m_1, \ldots , \m_S \}$.
    \end{itemize}
    \end{block}
    
    \vspace{-1mm}
    

	\begin{figure}
         	\centering
    \begin{tikzpicture}[x=0.14cm,y=0.14cm]

      \node(origin) at (0,0) {};
      \node(end) at ($(origin)+(10,10)$) {};
      
      \node(f_int_origin) at (0.5,0.5) {};
      \node(f_int_end) at (1.5,1.5) {};
      \node(l_int_origin) at (8.5,8.5) {};
      \node(l_int_end) at (9.5,9.5) {};
      
      \node(layer1) at ($(origin)+(0,-0)$) {};
      \node(layer1_end) at ($(layer1)+(10,10)$) {};
      
      \draw [draw=black,fill=white,thick] (layer1) rectangle (layer1_end);
      \draw[] ($(layer1)+(5,0)$) -- ($(layer1)+(5,10)$);
      \draw[] ($(layer1)+(0,5)$) -- ($(layer1)+(10,5)$);
      \node(s14) at ($(layer1)+(2.5,2.5)$) {$\sig_{3}^3$};
      \node(s15) at ($(layer1)+(7.5,2.5)$) {$\sig_{4}^3$};
      \node(s16) at ($(layer1)+(2.5,7.5)$) {$\sig_{1}^3$};
      \node(s17) at ($(layer1)+(7.5,7.5)$) {$\sig_{2}^3$};
      \node(l_m3) at ($(layer1)+(5,-2)$) {$\m_3$}; 
            
      \node(layer1_a) at ($(layer1)+(15,0)$) {};
      \node(layer1_end_a) at ($(layer1_end)+(15,0)$) {};
      \draw [draw=black,fill=white,thick] (layer1_a) rectangle (layer1_end_a);
      \draw[] ($(layer1_a)+(5,0)$) -- ($(layer1_a)+(5,10)$);
      \draw[] ($(layer1_a)+(0,5)$) -- ($(layer1_a)+(10,5)$);
      \node(s18) at ($(layer1_a)+(2.5,2.5)$) {$\sig_{3}^4$};
      \node(s19) at ($(layer1_a)+(7.5,2.5)$) {$\sig_{4}^4$};
      \node(s20) at ($(layer1_a)+(2.5,7.5)$) {$\sig_{1}^4$};
      \node(s21) at ($(layer1_a)+(7.5,7.5)$) {$\sig_{2}^4$};
      \node(l_m4) at ($(layer1_a)+(5,-2)$) {$\m_4$}; 
            
      \node(layer1_b) at ($(layer1_a)+(15,0)$) {};
      \node(layer1_end_b) at ($(layer1_end_a)+(15,0)$) {};
      \node(l_m8) at ($(layer1_b)+(0,-2)$) {$\cdots$}; 
      \node(l_m9) at ($(layer1_b)+(12,-2)$) {$\m_S$}; 
      \node(l_m5) at ($(layer1_b)+(17.5,5)$) {\tcr{Construction of $S$ $hp$-grids!}} ; 
      \node(l_m7) at ($(layer1_b)+(0,5)$) {$\rightarrow$ }; 

       \node(layer1_c) at ($(layer1)-(15,0)$) {};
      \node(layer1_end_c) at ($(layer1_end)-(15,0)$) {};
      \draw [draw=black,fill=white,thick] (layer1_c) rectangle (layer1_end_c);
      \draw[] ($(layer1_c)+(5,0)$) -- ($(layer1_c)+(5,10)$);
      \draw[] ($(layer1_c)+(0,5)$) -- ($(layer1_c)+(10,5)$);           
      \node(s10) at ($(layer1_c)+(2.5,2.5)$) {$\sig_{3}^2$};
      \node(s11) at ($(layer1_c)+(7.5,2.5)$) {$\sig_{4}^2$};
      \node(s12) at ($(layer1_c)+(2.5,7.5)$) {$\sig_{1}^2$};
      \node(s13) at ($(layer1_c)+(7.5,7.5)$) {$\sig_{2}^2$};
      \node(l_m2) at ($(layer1_c)+(5,-2)$) {$\m_2$}; 
      
       \node(layer1_d) at ($(layer1_c)-(15,0)$) {};
      \node(layer1_end_d) at ($(layer1_end_c)-(15,0)$) {};
      \draw [draw=black,fill=white,thick] (layer1_d) rectangle (layer1_end_d);
      \draw[] ($(layer1_d)+(5,0)$) -- ($(layer1_d)+(5,10)$);
      \draw[] ($(layer1_d)+(0,5)$) -- ($(layer1_d)+(10,5)$);          
      \node(s6) at ($(layer1_d)+(2.5,2.5)$) {$\sig_3^1$};
      \node(s7) at ($(layer1_d)+(7.5,2.5)$) {$\sig_4^1$};
      \node(s8) at ($(layer1_d)+(2.5,7.5)$) {$\sig_1^1$};
      \node(s9) at ($(layer1_d)+(7.5,7.5)$) {$\sig_2^1$};
      \node(l_m1) at ($(layer1_d)+(5,-2)$) {$\m_1$}; 
   
    \end{tikzpicture}
	\end{figure}

	\vspace{-1mm}

\begin{block}{Challenge: High Computational Cost}
\begin{itemize}
\item Building an \textbf{$\boldsymbol{hp}$-grid is computationally expensive} in general.
\item The number of problems $S$ can be \textbf{huge} (e.g., 100k problems).
\end{itemize}
\end{block}

	\vspace{1mm}

\begin{block}{Proposed Solution: One Grid to Rule Them All}
\textbf{Objective}: Build a \tcr{\underline{\textbf{single}} $hp$-mesh} that provides \tcr{accurate solutions for all $\m$ at once}.
\end{block}

\note[Moreover, due to the singularities or discontinuities in the derivatives along with material interfaces that the solutions may exhibit, these problems often demand rather fine or complex finite element grids to accurately describe them \\ enormous number of problems that DNNs employ for approximating the inverse operator in the training process, it becomes necessary to design efficient numerical methods that maintain the computational cost under control.]

\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{MAGO: (M)ulti-(A)daptive (G)oal-(O)riented}
	
	\vspace{-1mm}	

\begin{block}{Objective}
	To control the relative error, ensuring that it falls within a specified tolerance $TOL$:
	\begin{equation}
		\max_{i, \{\m_i\}_{i=1}^S} \left\{ \frac{\abs{l(\umi^F)-l(\umi^C)}}{\abs{l(\umi^F)}}\right\} < TOL.
	\end{equation}
\end{block}

\vspace{1mm}

\begin{block}{Coarsening Step with a Single Mesh}
	\vspace{2mm}
	We employ a coarsening step using a single mesh, which involves the following stages:
	\begin{enumerate}
		\item Solve the finite element method (FEM) problem for each $\boldsymbol{m}_i$.
		\item Compute element-wise error indicators for each $\boldsymbol{m}_i$.
		\item Combine all the element-wise error indicators into a unified measure.
		\item Perform mesh unrefinement based on the combined error measure.
	\end{enumerate}
\end{block}

\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{MAGO: (M)ulti-(A)daptive (G)oal-(O)riented}
\vspace{-2mm}

\vspace{-1mm}

	\begin{figure}
         	\centering
    \begin{tikzpicture}[x=0.27cm,y=0.27cm]

      \node(origin) at (0,0) {};
      \node(end) at ($(origin)+(10,10)$) {};
      
      \node(f_int_origin) at (0.5,0.5) {};
      \node(f_int_end) at (1.5,1.5) {};
      \node(l_int_origin) at (8.5,8.5) {};
      \node(l_int_end) at (9.5,9.5) {};
      
      	
 
       \draw [draw=black,fill=white,very thick] (origin) rectangle (end);
      \draw [draw=black,fill=brown!20,very thick] (origin) rectangle ($(origin)+(5,5)$);
      \draw [draw=black,fill=gray!20,very thick] ($(origin)+(5,0)$) rectangle ($(origin)+(10,5)$);
      \draw [draw=black,fill=purple!20,very thick] ($(origin)+(0,5)$) rectangle ($(origin)+(5,10)$);
      \draw [draw=black,fill=orange!40,very thick] ($(origin)+(5,5)$) rectangle ($(origin)+(10,10)$);
      
      \draw[] ($(origin)+(2.5,0)$) -- ($(origin)+(2.5,10)$);
      \draw[] ($(origin)+(7.5,0)$) -- ($(origin)+(7.5,10)$);
      \draw[] ($(origin)+(0,2.5)$) -- ($(origin)+(10,2.5)$);
      \draw[] ($(origin)+(0,7.5)$) -- ($(origin)+(10,7.5)$);
            
      \node(e) at ($(origin)+(1.25,1.25)$) {\normalsize{$\eta^1_{13}$}};
      \node(e) at ($(origin)+(3.75,1.25)$) {\normalsize{$\eta^1_{14}$}};
      \node(e) at ($(origin)+(6.25,1.25)$) {\normalsize{$\eta^1_{15}$}};
      \node(e) at ($(origin)+(8.75,1.25)$) {\normalsize{$\eta^1_{16}$}};
      
      \node(e) at ($(origin)+(1.25,3.75)$) {\normalsize{$\eta^1_{9}$}};
      \node(e) at ($(origin)+(3.75,3.75)$) {\normalsize{$\eta^1_{10}$}};
      \node(e) at ($(origin)+(6.25,3.75)$) {\normalsize{$\eta^1_{11}$}};
      \node(e) at ($(origin)+(8.75,3.75)$) {\normalsize{$\eta^1_{12}$}};
      
      \node(e) at ($(origin)+(1.25,6.25)$) {\normalsize{$\eta^1_{5}$}};
      \node(e) at ($(origin)+(3.75,6.25)$) {\normalsize{$\eta^1_{6}$}};
      \node(e) at ($(origin)+(6.25,6.25)$) {\normalsize{$\eta^1_{7}$}};
      \node(e) at ($(origin)+(8.75,6.25)$) {\normalsize{$\eta^1_{8}$}};
      
      \node(e) at ($(origin)+(1.25,8.75)$) {\normalsize{$\eta^1_{1}$}};
      \node(e) at ($(origin)+(3.75,8.75)$) {\normalsize{$\eta^1_{2}$}};
      \node(e) at ($(origin)+(6.25,8.75)$) {\normalsize{$\eta^1_{3}$}};
      \node(e) at ($(origin)+(8.75,8.75)$) {\normalsize{$\eta^1_{4}$}};
            
      \node(l_m1) at ($(origin)+(5,-1)$) {$\m_1$}; 
      
      
      
      \node(layer1) at ($(origin)+(13,-0)$) {};
      \node(layer1_end) at ($(layer1)+(10,10)$) {};      
%      \draw [draw=black,fill=white,very thick] (layer1) rectangle (layer1_end);
      \draw [draw=black,fill=green!20,very thick] (layer1) rectangle ($(layer1)+(5,5)$);
      \draw [draw=black,fill=blue!20,very thick] ($(layer1)+(5,0)$) rectangle ($(layer1)+(10,5)$);
      \draw [draw=black,fill=brown!50,very thick] ($(layer1)+(0,5)$) rectangle ($(layer1)+(5,10)$);
      \draw [draw=black,fill=red!30,very thick] ($(layer1)+(5,5)$) rectangle ($(layer1)+(10,10)$);
      
      \draw[] ($(layer1)+(2.5,0)$) -- ($(layer1)+(2.5,10)$);
      \draw[] ($(layer1)+(7.5,0)$) -- ($(layer1)+(7.5,10)$);
      \draw[] ($(layer1)+(0,2.5)$) -- ($(layer1)+(10,2.5)$);
      \draw[] ($(layer1)+(0,7.5)$) -- ($(layer1)+(10,7.5)$);
            
      \node(e) at ($(layer1)+(1.25,1.25)$) {\normalsize{$\eta^2_{13}$}};
      \node(e) at ($(layer1)+(3.75,1.25)$) {\normalsize{$\eta^2_{14}$}};
      \node(e) at ($(layer1)+(6.25,1.25)$) {\normalsize{$\eta^2_{15}$}};
      \node(e) at ($(layer1)+(8.75,1.25)$) {\normalsize{$\eta^2_{16}$}};
      
      \node(e) at ($(layer1)+(1.25,3.75)$) {\normalsize{$\eta^2_{9}$}};
      \node(e) at ($(layer1)+(3.75,3.75)$) {\normalsize{$\eta^2_{10}$}};
      \node(e) at ($(layer1)+(6.25,3.75)$) {\normalsize{$\eta^2_{11}$}};
      \node(e) at ($(layer1)+(8.75,3.75)$) {\normalsize{$\eta^2_{12}$}};
      
      \node(e) at ($(layer1)+(1.25,6.25)$) {\normalsize{$\eta^2_{5}$}};
      \node(e) at ($(layer1)+(3.75,6.25)$) {\normalsize{$\eta^2_{6}$}};
      \node(e) at ($(layer1)+(6.25,6.25)$) {\normalsize{$\eta^2_{7}$}};
      \node(e) at ($(layer1)+(8.75,6.25)$) {\normalsize{$\eta^2_{8}$}};
      
      \node(e) at ($(layer1)+(1.25,8.75)$) {\normalsize{$\eta^2_{1}$}};
      \node(e) at ($(layer1)+(3.75,8.75)$) {\normalsize{$\eta^2_{2}$}};
      \node(e) at ($(layer1)+(6.25,8.75)$) {\normalsize{$\eta^2_{3}$}};
      \node(e) at ($(layer1)+(8.75,8.75)$) {\normalsize{$\eta^2_{4}$}};
            
      \node(l_m2) at ($(layer1)+(5,-1)$) {$\m_2$}; 

      \node(arr) at ($(layer1)+(14,5)$) {$\boldsymbol{\cdots}$}; 

      

      \node(layer2) at ($(layer1)+(18,-0)$) {};
      \node(layer2_end) at ($(layer2)+(10,10)$) {};
%      \draw [draw=black,fill=white,very thick] (layer2) rectangle (layer2_end);
      \draw [draw=black,fill=red!60,very thick] (layer2) rectangle ($(layer2)+(5,5)$);
      \draw [draw=black,fill=orange!10,very thick] ($(layer2)+(5,0)$) rectangle ($(layer2)+(10,5)$);
      \draw [draw=black,fill=yellow!77,very thick] ($(layer2)+(0,5)$) rectangle ($(layer2)+(5,10)$);
      \draw [draw=black,fill=black!25,very thick] ($(layer2)+(5,5)$) rectangle ($(layer2)+(10,10)$);
      
      \draw[] ($(layer2)+(2.5,0)$) -- ($(layer2)+(2.5,10)$);
      \draw[] ($(layer2)+(7.5,0)$) -- ($(layer2)+(7.5,10)$);
      \draw[] ($(layer2)+(0,2.5)$) -- ($(layer2)+(10,2.5)$);
      \draw[] ($(layer2)+(0,7.5)$) -- ($(layer2)+(10,7.5)$);
            
      \node(e) at ($(layer2)+(1.25,1.25)$) {\normalsize{$\eta^S_{13}$}};
      \node(e) at ($(layer2)+(3.75,1.25)$) {\normalsize{$\eta^S_{14}$}};
      \node(e) at ($(layer2)+(6.25,1.25)$) {\normalsize{$\eta^S_{15}$}};
      \node(e) at ($(layer2)+(8.75,1.25)$) {\normalsize{$\eta^S_{16}$}};
      
      \node(e) at ($(layer2)+(1.25,3.75)$) {\normalsize{$\eta^S_{9}$}};
      \node(e) at ($(layer2)+(3.75,3.75)$) {\normalsize{$\eta^S_{10}$}};
      \node(e) at ($(layer2)+(6.25,3.75)$) {\normalsize{$\eta^S_{11}$}};
      \node(e) at ($(layer2)+(8.75,3.75)$) {\normalsize{$\eta^S_{12}$}};
      
      \node(e) at ($(layer2)+(1.25,6.25)$) {\normalsize{$\eta^S_{5}$}};
      \node(e) at ($(layer2)+(3.75,6.25)$) {\normalsize{$\eta^S_{6}$}};
      \node(e) at ($(layer2)+(6.25,6.25)$) {\normalsize{$\eta^S_{7}$}};
      \node(e) at ($(layer2)+(8.75,6.25)$) {\normalsize{$\eta^S_{8}$}};
      
      \node(e) at ($(layer2)+(1.25,8.75)$) {\normalsize{$\eta^S_{1}$}};
      \node(e) at ($(layer2)+(3.75,8.75)$) {\normalsize{$\eta^S_{2}$}};
      \node(e) at ($(layer2)+(6.25,8.75)$) {\normalsize{$\eta^S_{3}$}};
      \node(e) at ($(layer2)+(8.75,8.75)$) {\normalsize{$\eta^S_{4}$}};
            
      \node(l_m2) at ($(layer2)+(5,-1)$) {$\m_S$}; 
  
    \end{tikzpicture}
\end{figure}
	
	\vspace{-12mm}
		\begin{figure}
         	\centering
    \begin{tikzpicture}[x=0.4cm,y=0.4cm]

      \node(origin) at (0,0) {};
      \node(end) at ($(origin)+(10,10)$) {};
      
      \node(f_int_origin) at (0.5,0.5) {};
      \node(f_int_end) at (1.5,1.5) {};
      \node(l_int_origin) at (8.5,8.5) {};
      \node(l_int_end) at (9.5,9.5) {};
      
      \draw [very thick] ($(origin)+(-7,11)$) to[out=-60, in=135] ($(origin)+(5,10.2)$);
      \draw [very thick] ($(origin)+(18,11)$) to[out=-120, in=45] ($(origin)+(5,10.2)$);
       \draw [draw=black,fill=white,very thick] (origin) rectangle (end);
%      \draw [draw=black,fill=brown!20,very thick] (origin) rectangle ($(origin)+(5,5)$);
%      \draw [draw=black,fill=gray!20,very thick] ($(origin)+(5,0)$) rectangle ($(origin)+(10,5)$);
%      \draw [draw=black,fill=purple!20,very thick] ($(origin)+(0,5)$) rectangle ($(origin)+(5,10)$);
%      \draw [draw=black,fill=orange!40,very thick] ($(origin)+(5,5)$) rectangle ($(origin)+(10,10)$);
      
      \draw[] ($(origin)+(2.5,0)$) -- ($(origin)+(2.5,10)$);
      \draw[] ($(origin)+(5,0)$) -- ($(origin)+(5,10)$);
      \draw[] ($(origin)+(7.5,0)$) -- ($(origin)+(7.5,10)$);
      \draw[] ($(origin)+(0,2.5)$) -- ($(origin)+(10,2.5)$);
      \draw[] ($(origin)+(0,5)$) -- ($(origin)+(10,5)$);
      \draw[] ($(origin)+(0,7.5)$) -- ($(origin)+(10,7.5)$);
            
      \node(e) at ($(origin)+(1.25,1.25)$) {\Large{$\eta_{13}$}};
      \node(e) at ($(origin)+(3.75,1.25)$) {\Large{$\eta_{14}$}};
      \node(e) at ($(origin)+(6.25,1.25)$) {\Large{$\eta_{15}$}};
      \node(e) at ($(origin)+(8.75,1.25)$) {\Large{$\eta_{16}$}};
      
      \node(e) at ($(origin)+(1.25,3.75)$) {\Large{$\eta_{9}$}};
      \node(e) at ($(origin)+(3.75,3.75)$) {\Large{$\eta_{10}$}};
      \node(e) at ($(origin)+(6.25,3.75)$) {\Large{$\eta_{11}$}};
      \node(e) at ($(origin)+(8.75,3.75)$) {\Large{$\eta_{12}$}};
      
      \node(e) at ($(origin)+(1.25,6.25)$) {\Large{$\eta_{5}$}};
      \node(e) at ($(origin)+(3.75,6.25)$) {\Large{$\eta_{6}$}};
      \node(e) at ($(origin)+(6.25,6.25)$) {\Large{$\eta_{7}$}};
      \node(e) at ($(origin)+(8.75,6.25)$) {\Large{$\eta_{8}$}};
      
      \node(e) at ($(origin)+(1.25,8.75)$) {\Large{$\eta_{1}$}};
      \node(e) at ($(origin)+(3.75,8.75)$) {\Large{$\eta_{2}$}};
      \node(e) at ($(origin)+(6.25,8.75)$) {\Large{$\eta_{3}$}};
      \node(e) at ($(origin)+(8.75,8.75)$) {\Large{$\eta_{4}$}};
            
      \node(l_m4) at ($(origin)+(-7,5)$) {\large{\tcr{A single $hp$-grid}}}; 
%      \node(l_m5) at ($(origin)+(-7,5)$) {combining all}; 
%      \node(l_m6) at ($(origin)+(-7,3)$) {error indicators}; 
      \node(l_m7) at ($(origin)+(-2,5)$) {$\rightarrow$}; 
      
      \node(l_m8) at ($(origin)+(16,7)$) {Different Alternatives}; 
      \node(l_m8) at ($(origin)+(16,5.75)$) {to combine the}; 
      \node(l_m8) at ($(origin)+(16,4.25)$) {error indicators:}; 
      \node(l_m9) at ($(origin)+(16,2)$) {$l_1$-norm, $l_2$-norm, $l_\infty$-norm}; 
  
    \end{tikzpicture}
\end{figure}


\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{MAGO: (M)ulti-(A)daptive (G)oal-(O)riented}
	\underline{\textbf{\tcr{\Large{Main Advantages}}}}:

\begin{itemize}
	\item \textbf{Single $\boldsymbol{hp}$-mesh}:
	\begin{itemize}
		\item Easier implementation.
	\end{itemize}
	
	\vspace{5mm}
	
	\item \textbf{Precomputation and Parallelization}:
	\begin{itemize}
		\item Precompute integrals of stiffness matrix, right-hand sides and error indicators.
		\item Parallelize the adaptive process and database generation.
		\item Compute the analysis part (symbolic factorization) once.
	\end{itemize}
\end{itemize}

\end{frame}
%================================================================================================================
\section{Numerical Experiments: Proof of Concept}
%================================================================================================================
\begin{frame}
    \frametitle{Outline}
    \tableofcontents[currentsection]
\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{Poisson Problem: $-\nabla \cdot ( \tcr{\boldsymbol{\sigma(x)}} \nabla u) = \mathds{1}_{\Omega_{f}}$}
	\begin{figure}[t!]
  		\plotskew{mate}
	\end{figure}
%	\begin{alignat}{2}
%		- \nabla \cdot ( \tcr{\boldsymbol{\sigma}} \nabla u)  & = \mathds{1}_{\Omega_{f}} &  & \text{ in } \Omega,    \\
%		u                                                                               & =0                                        &  & \text{ on } \textcolor{blue}{\Gamma}.
%	\end{alignat}
	\note{Applications}
\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{MAGO: $hp$-adapted mesh. $1\%$ max-error (100 samples)}
		\plothpmeshes[]{Poisson2D}
\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{MAGO: Comparison Between Norms in Error Indicator}
	\begin{figure}
		\centering
		\begin{tikzpicture}
			\begin{axis}[
				xlabel={Number of DoF},
				ylabel=Relative error in the QoI (\%),
				ymode=log,
				xmode=log,
				ymin=-10,
				ymax=110,
				xmin=50,
				xmax=1e5,
				ylabel near ticks,
				xlabel near ticks,
				enlargelimits=true,
				legend style={draw=black,fill=white,legend cell align=left, at={(0.5,1.01)}, anchor=south},
				legend columns=-1,
				height=\plotheight,
				width=0.7\plotwidth
				]
				
				%\addplot+ [mark size=3.5pt,mark=o] table[x =nr_dof,y=ErrorQoI_linf ]{Figures/adapt_100/Adapt/norm_0/outputs.txt} ;
				\addplot+[ line width=1pt] table[x =nr_dof,y=ErrorQoI_linf ]{Figures/adapt_100/Adapt/norm_0/outputs.txt};
				\addlegendentry{$|| \cdot ||_{\infty}$}
				
				 \addplot+[ line width=1pt] table[x =nr_dof,y=ErrorQoI_linf]{Figures/adapt_100/Adapt/norm_1/outputs.txt};
				%\addplot+ [dashed,mark size=5.5pt,mark=x] table[x =nr_dof,y=ErrorQoI_linf]{Figures/adapt_100/Adapt/norm_1/outputs.txt};
				\addlegendentry{$|| \cdot ||_{1}$}
				
				\addplot+[ line width=1pt] table[x =nr_dof,y=ErrorQoI_linf]{Figures/adapt_100/Adapt/norm_2/outputs.txt};
				%\addplot+ [green!70!black!70,dotted,mark size=6.0pt,mark=|] table[x =nr_dof,y=ErrorQoI_linf]{Figures/adapt_100/Adapt/norm_2/outputs.txt} ;
				\addlegendentry{$|| \cdot ||_{2}$}
				
			\end{axis}
		\end{tikzpicture}
		\caption{Convergence for different norms in the error indicators (adaptive process of 100 samples)}
	\end{figure}
\end{frame}
%================================================================================================================
\begin{frame}{MAGO: Testing the Adaptive Meshes (1K samples)}
	\boxplotmagocheck[Results/boxplot]{_1k}{mat_adapt_1}{mat_adapt_5}{mat_adapt_10}{mat_adapt_50}{mat_adapt_100}
\end{frame}
%================================================================================================================
\begin{frame}{MAGO: Importance of the Number of Validation Samples}
	\boxplotmagochecksize[Results/boxplot]{mat_adapt_10}{10}
\end{frame}
%================================================================================================================
\begin{frame}[c]
	\frametitle{Summary}
	\vspace{5mm}
	\begin{itemize}
		\item Robust automatic $hp$-adaptive strategy for a given model.
		\vspace{7mm}
		\item \textbf{Extension} of the strategy to \textbf{parametric PDEs}.
		\vspace{3mm}
		\begin{itemize}
			\item Single $hp$-mesh for any model parameters.
		\end{itemize}
		\vspace{7mm}
		\item \textbf{High computational} cost savings (precomputations and parallelizations).
		\vspace{7mm}
		\item \textbf{Promising approach} for generating \tcr{databases for DL inversion}.
		\vspace{3mm}
		\begin{itemize}
			\item Fast generation of synthetic measurements (100k in hours on a laptop).
		\end{itemize}
	\end{itemize}
	\begin{center}
    \begin{tabular}{|c|c|}
      \hline
      \textbf{Number of  Training Samples} & \textbf{Time} \\
      \hline
      1 & $\sim10$ min \\
      10 & $\sim80$ min \\
      100 & $\sim28$h (1sam/s) \\
      \hline
    \end{tabular}
    %\captionof{table}{Generating Databases of 100K Samples.}
  \end{center}
\end{frame}
%================================================================================================================
\begin{frame}
	\frametitle{Ongoing and Future Work}
	\begin{itemize}
		\item Obtain numerical estimations of the savings in computational cost.
		\vspace{5mm}
		\item Study the impact of different random samples on Deep Learning Inversion.
		\vspace{5mm}
		\item Explore methods for further acceleration (e.g., increased parallelization, enhanced factorization).
		\vspace{5mm}
		\item Extend the strategy to real applications such as Magnetotellurics, Controlled Source EM, LWD.
	\end{itemize}
\end{frame}
%================================================================================================================
%\begin{frame}
%	\frametitle{Goal-Oriented Adaptivity}
%\begin{block}{Element-Wise ($K$) Error Indicators}
%	We obtain error indicators $\eta_K$ that measure the importance of each basis function.
%\end{block}

%\begin{block}{}
%\begin{figure}
%	\centering
%	\begin{tikzpicture}[x=0.14cm,y=0.14cm]
%	
%	\node(origin) at (0,0) {};
%	\node(end) at ($(origin)+(10,10)$) {};
%	
%	\node(f_int_origin) at (0.5,0.5) {};
%	\node(f_int_end) at (1.5,1.5) {};
%	\node(l_int_origin) at (8.5,8.5) {};
%	\node(l_int_end) at (9.5,9.5) {};
%	
%	\node(layer1) at ($(origin)+(0,-0)$) {};
%	\node(layer1_end) at ($(layer1)+(10,10)$) {};
%	
%	\draw [draw=black,fill=white,thick] (origin) rectangle (end);
%	\draw[] ($(origin)+(5,0)$) -- ($(origin)+(5,10)$);
%	\draw[] ($(origin)+(0,5)$) -- ($(origin)+(10,5)$);
%	\node(s1) at ($(origin)+(2.5,2.5)$) {$\sig_3$};
%	\node(s2) at ($(origin)+(7.5,2.5)$) {$\sig_4$};
%	\node(s3) at ($(origin)+(2.5,7.5)$) {$\sig_1$};
%	\node(s4) at ($(origin)+(7.5,7.5)$) {$\sig_2$};
%	\node(s5) at ($(origin)+(5,-2)$) {$\m$}; 
%	\node(ss) at ($(origin)+(30,5)$) {$\rightarrow$ \hspace{3mm} Construction of $1$ $hp$-grid};
%	\node(sss) at ($(origin)+(-24,7.5)$) {$\m = \{\sig_1, \ldots, \sig_N\}$};
%	\node(ssss) at ($(origin)+(-24,2.5)$) {$1$ sample of model parameters};
%	
%	
%	\end{tikzpicture}
%\end{figure}
%\end{block}

%\begin{figure}
%	\centering
%	\begin{tikzpicture}[x=0.45cm,y=0.5cm]
%	
%		\node(origin) at (0,0) {};
%		\node(end) at ($(origin)+(10,10)$) {};
%		
%		\node(f_int_origin) at (0.5,0.5) {};
%		\node(f_int_end) at (1.5,1.5) {};
%		\node(l_int_origin) at (8.5,8.5) {};
%		\node(l_int_end) at (9.5,9.5) {};
%		
%		\node(layer1) at ($(origin)+(13,-0)$) {};
%		\node(layer1_end) at ($(layer1)+(10,10)$) {};
%		
%		\draw [draw=black,fill=white,very thick] (origin) rectangle (end);
%		\draw [draw=black,fill=brown!20,very thick] (origin) rectangle ($(origin)+(5,5)$);
%		\draw [draw=black,fill=gray!20,very thick] ($(origin)+(5,0)$) rectangle ($(origin)+(10,5)$);
%		\draw [draw=black,fill=purple!20,very thick] ($(origin)+(0,5)$) rectangle ($(origin)+(5,10)$);
%		\draw [draw=black,fill=orange!40,very thick] ($(origin)+(5,5)$) rectangle ($(origin)+(10,10)$);
%		
%		\node(s1) at ($(origin)+(2.5,2.5)$) {\Large{$\sig_3$}};
%		\node(s2) at ($(origin)+(7.5,2.5)$) {\Large{$\sig_4$}};
%		\node(s3) at ($(origin)+(2.5,7.5)$) {\Large{$\sig_1$}};
%		\node(s4) at ($(origin)+(7.5,7.5)$) {\Large{$\sig_2$}};
%		\node(s5) at ($(origin)+(5,-1)$) {\tcr{(a)} Model Parameters Grid};
%		
%		\node(arr) at ($(layer1)+(-1.5,5)$) {$\rightarrow$}; 
%		\draw [draw=black,fill=white,very thick] (layer1) rectangle (layer1_end);
%		\draw [draw=black,fill=brown!20,very thick] (layer1) rectangle ($(layer1)+(5,5)$);
%		\draw [draw=black,fill=gray!20,very thick] ($(layer1)+(5,0)$) rectangle ($(layer1)+(10,5)$);
%		\draw [draw=black,fill=purple!20,very thick] ($(layer1)+(0,5)$) rectangle ($(layer1)+(5,10)$);
%		\draw [draw=black,fill=orange!40,very thick] ($(layer1)+(5,5)$) rectangle ($(layer1)+(10,10)$);
%		
%		\draw[] ($(layer1)+(2.5,0)$) -- ($(layer1)+(2.5,10)$);
%		\draw[] ($(layer1)+(7.5,0)$) -- ($(layer1)+(7.5,10)$);
%		\draw[] ($(layer1)+(0,2.5)$) -- ($(layer1)+(10,2.5)$);
%		\draw[] ($(layer1)+(0,7.5)$) -- ($(layer1)+(10,7.5)$);
%		
%		\node(e) at ($(layer1)+(1.25,1.25)$) {\Large{$\eta_{13}$}};
%		\node(e) at ($(layer1)+(3.75,1.25)$) {\Large{$\eta_{14}$}};
%		\node(e) at ($(layer1)+(6.25,1.25)$) {\Large{$\eta_{15}$}};
%		\node(e) at ($(layer1)+(8.75,1.25)$) {\Large{$\eta_{16}$}};
%		
%		\node(e) at ($(layer1)+(1.25,3.75)$) {\Large{$\eta_{9}$}};
%		\node(e) at ($(layer1)+(3.75,3.75)$) {\Large{$\eta_{10}$}};
%		\node(e) at ($(layer1)+(6.25,3.75)$) {\Large{$\eta_{11}$}};
%		\node(e) at ($(layer1)+(8.75,3.75)$) {\Large{$\eta_{12}$}};
%		
%		\node(e) at ($(layer1)+(1.25,6.25)$) {\Large{$\eta_{4}$}};
%		\node(e) at ($(layer1)+(3.75,6.25)$) {\Large{$\eta_{5}$}};
%		\node(e) at ($(layer1)+(6.25,6.25)$) {\Large{$\eta_{6}$}};
%		\node(e) at ($(layer1)+(8.75,6.25)$) {\Large{$\eta_{7}$}};
%		
%		\node(e) at ($(layer1)+(1.25,8.75)$) {\Large{$\eta_{1}$}};
%		\node(e) at ($(layer1)+(3.75,8.75)$) {\Large{$\eta_{2}$}};
%		\node(e) at ($(layer1)+(6.25,8.75)$) {\Large{$\eta_{3}$}};
%		\node(e) at ($(layer1)+(8.75,8.75)$) {\Large{$\eta_{4}$}};
%		
%		\node(l_m3) at ($(layer1)+(5,-1)$) {\tcr{(b)} FEM Grid (Conforming with Parameters)};
%		
%	\end{tikzpicture}
%\end{figure}
%
%\end{frame}
%================================================================================================================
%\begin{frame}
%\frametitle{Goal-Oriented Adaptivity}
%
%\begin{block}{The objective in Goal-Oriented Adaptivity}
%	To produce a space $\H_{\calF}$ with minimum dimension such that
%	\vspace{-2mm}
%	\begin{align}
%	\abs{l(u^{\calF})-l(u)} < \varepsilon, \quad \text{for any } \varepsilon > 0,
%	\end{align}
%	where \tcr{$l(\cdot)$} is a linear and continuous functional that defines the \tcr{Quantity of Interest} (QoI).
%\end{block}
%
%\begin{block}{Discrete Variational Formulations}
%	Given a model $\m$, find $\um^{\calF}, \vm^{\calF} \in \H_{\calF}$ such that
%	\vspace{-1mm}
%	\begin{equation*}
%	\begin{array}{lrcl}
%	\text{Forward Problem:} \hspace{15mm} & b(\um^{\calF},\phi^{\calF}) & = & f(\phi^{\calF}), \quad \forall \phi^{\calF} \in \H_{\calF},   \\[2mm]
%	\text{Adjoint Problem:} \hspace{15mm} & b(\phi^{\calF},\vm^{\calF}) & = & l(\phi^{\calF}), \quad \forall \phi^{\calF} \in \H_{\calF}. \\
%	\end{array}
%	\end{equation*}
%\end{block}
%
%%Explain the process of constructing a $1$ $hp$-grid, as depicted in the figure. Elaborate on the different elements $\sig_1, \sig_2, \sig_3, \sig_4$, and $\m$, which represent the grid elements and the model parameters, respectively. Emphasize that the goal is to construct an optimized grid based on the given model parameters.
%
%%Emphasize the significance of minimizing the dimension of the adapted space $\H_{\calF}$ while maintaining the desired accuracy in the quantity of interest. Explain how this optimization process allows for efficient computations and resource utilization.
%
%\end{frame}
%================================================================================================================
%\begin{frame}{MAGO: Meaning of a Box Plot}
%	\begin{figure}
%		\centering
%		\begin{tikzpicture}
%		\begin{axis}[
%			boxplot/draw direction=y,
%			boxplot/variable width,
%			x axis line style={opacity=0},
%			axis x line*=bottom,
%			axis y line=left,
%			enlarge y limits,
%			xtick={1},
%			xticklabels={},
%			height=\plotheight,
%			width=0.8\plotwidth,
%			ymin=-0.1,
%			xmax=2,
%			ymax=10,
%			ylabel={Relative error in the QoI (\%)},
%		]
%		
%		\addplot+[
%			boxplot prepared={
%				median=5,
%				upper quartile=7,
%				lower quartile=3,
%				upper whisker=10,
%				lower whisker=1,
%				every box/.style={black,very thick},
%				every whisker/.style={blue, very thick},
%				every median/.style={red,ultra thick},
%			},
%		] coordinates {};
%		
%		\node[blue] at (1.65,10) {\large upper whisker};
%		\node(q3)[black] at (1.5,6.75) {\large Q3};
%		\node[red] at (1.55,5) {\large median};
%		\node(q1)[black] at (1.5,3) {\large Q1};
%		\node[blue] at (1.65,1) {\large lower whisker};
%		
%		\draw[|-|,thick] (1.72,7) -- (1.72,3);
%		\node[black] at (1.85,5) {\large IQR};
%		
%		\end{axis}
%		\end{tikzpicture}
%		% \caption{Box plot for different number of adaptive grids with a \textbf{threshold max-error of 1 $\%$}.}
%		% \caption{Box plot for \textbf{different adaptive grids} with a threshold error of 1 $\%$}
%	\end{figure}
%	
%	\begin{center}
%		$\bullet$ upper whisker = $Q3+1.5$ IQR
%		
%		\vspace{3mm}
%		
%		$\bullet$ lower whisker = $Q1-1.5$ IQR
%	\end{center}
%\end{frame}
%================================================================================================================
%\begin{frame}{MAGO: Limiting the NDoFs (10K testing samples)}
%	\boxplotmagoNdof[Results/boxplot/ndofs_comparison]{10000}{1_10k}{5_10k}{10_10k}{100_10k}
%\end{frame}

\end{document}